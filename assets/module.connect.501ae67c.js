import{g as i}from"./index.2d9ac2c0.js";import{n as r}from"./main.cb96ee43.js";import{w as u}from"./web3.20248db3.js";var p={init(){this.accountsConnect(),this.accountsChanged(),this.chainChanged(),this.isPolygonNetwork()},createList(t,e){const o=document.createElement("ul");o.className=e;for(const n of t){const c=document.createElement("li");c.textContent=n.name,n.class?c.className=n.class:c.className=n.name.toLowerCase(),o.appendChild(c),e==="connectwallets"&&c.addEventListener("click",a=>{switch(a.target.className){case"metamask":this.connectMetaMask(c);break}},!1)}return o},overlayPopup(t=null,e=null,o=!1){r();const n=document.createElement("div");n.className="overlay-popup",document.body.appendChild(n);const c=document.createElement("div");if(c.className="op-box",n.appendChild(c),t){const l=document.createElement("div");l.className="op-title header-title m-b-24",l.textContent=t,c.appendChild(l)}const a=document.createElement("div");o?a.className="op-close hide":a.className="op-close cursor",c.appendChild(a),a.addEventListener("click",()=>{this.closeOverlayPopup()},!1);const s=document.createElement("div");s.className="op-content",s.appendChild(e),c.appendChild(s),i.from(c,{opacity:0,scale:.5})},closeOverlayPopup(){const t=document.querySelector(".overlay-popup");t&&(r(!1),i.to(document.querySelector(".op-box"),{opacity:0,scale:.5,duration:.35,onComplete:function(){t.remove()}}))},async connectMetaMask(t){t.textContent="Requesting...";try{await window.ethereum.request({method:"eth_requestAccounts"}).then(e=>{this.closeOverlayPopup(),this.accountsConnect()}).catch(e=>{throw console.log("eth_requestAccounts error",e),e})}catch(e){console.log("error",e)}},accountsConnect(){ethereum.request({method:"eth_accounts"}).then(t=>{const e=document.querySelector(".connection-button");if(e)if(t.length>0){e.textContent="";const o=String(t),n=document.createElement("div");n.className="in-border white-50 icon icon-account active-account",n.textContent=`${o.substring(0,4)}...${o.substring(o.length-4)}`,e.appendChild(n)}else{const o=document.createElement("div");o.className="button",e.appendChild(o);const n=document.createElement("a");n.setAttribute("href","#"),n.className="btn btn-blue js-connectWallet",n.textContent="Connect wallet",o.appendChild(n),n.addEventListener("click",c=>{c.preventDefault();const a=[{name:"Metamask"},{name:"Walletconnect"},{name:"Coinbase"}];this.overlayPopup("Connect Wallet",this.createList(a,"connectwallets"))},!1)}}).catch(t=>{throw console.log("eth_accounts error",t),t})},accountsChanged(){window.ethereum.on("accountsChanged",t=>{if(this.isPolygonNetwork(),t.length>0){const e=String(t);document.querySelector("header .active-account").textContent=`${e.substring(0,4)}...${e.substring(e.length-4)}`}else location.reload()})},chainChanged(){window.ethereum.on("chainChanged",t=>{this.isPolygonNetwork()})},async isPolygonNetwork(){if((await u.eth.getAccounts()).length>0){const e=await u.eth.getChainId();if(Number(e)===137)this.closeOverlayPopup();else{const o=[{name:"",class:"np-icon"},{name:"This is not a \u201CPolygon\u201D blockchain!",class:"np-text size-lgmd"}];this.overlayPopup(null,this.createList(o,"notpolygon"),!0)}}}};export{p as default};
