import{c as s,d as c,s as n,h as p}from"./main.99bfe8ec.js";import{a as u,b as m,d as y,e as d,f as v}from"./web3.4b9bfd87.js";import i from"./component.dropdownSelect.d9f6f5d4.js";import S from"./component.percentageBar.dc88468b.js";import l from"./component.toggleSwitches.8990d3da.js";import b from"./component.tradingviewWidget.4607064f.js";var w={globals:{elem:document.querySelector(".trader"),initObserver:!0},init(){this.optExpiry(),this.setTrade(),new MutationObserver(t=>{console.log("sidenav has changed from Trader!");for(let o of t)if(o.type==="attributes")switch(o.attributeName){case"sidenav-activechange":b.createGraph(),this.optToken(),this.optStrike(),this.optPrice(),this.liquidityPool();break;case"sidenav-refreshprice":this.optPrice();break}this.globals.initObserver=!1}).observe(this.globals.elem.querySelector(".sidenav"),{childList:!0,attributes:!0,attributeFilter:["sidenav-activechange","sidenav-refreshprice"]}),new MutationObserver(t=>{this.globals.initObserver||this.optStrike()}).observe(document.querySelector(".opt-callput"),{childList:!1,attributes:!0,characterData:!1}),new MutationObserver(async t=>{this.globals.initObserver||this.optToken()}).observe(document.querySelector(".opt-expiry .ds-value1"),{childList:!0,attributes:!1,characterData:!1})},async optToken(){const e=document.querySelector(".opt-expiry .ds-value1").textContent.replace("Days","").replace("Day","").trim(),r=await u(null,e);document.querySelector(".opt-token .ts-token").textContent=r},optStrike(){const e=l.getActiveItem(document.querySelector(".opt-callput")).toLowerCase()==="call";i.createListItems(document.querySelector(".opt-strike"),m(null,e),!1)},optExpiry(){i.createListItems(document.querySelector(".opt-expiry"),y())},async optPrice(e=null){console.log("optPrice()");const r=l.getActiveItem(document.querySelector(".opt-buysell")).toLowerCase()==="buy",a=l.getActiveItem(document.querySelector(".opt-callput")).toLowerCase()==="call";new Promise((t,o)=>{setTimeout(()=>{t({strike:document.querySelector(".opt-strike .ds-value1").textContent.trim(),expiry:document.querySelector(".opt-expiry .ds-value1").textContent.replace("Days","").replace("Day","").trim()})},e?500:2e3)}).then(async t=>{const o=await d(null,s(),r,a,0,t.strike,1e-5,t.expiry);e?(e.volatility.textContent=o.volatility,e.premium.textContent=o.premium,e.collateral.textContent=o.collateral):(document.querySelector(".opt-price .info-volatility").textContent=o.volatility,document.querySelector(".opt-price .info-premium").textContent=o.premium,document.querySelector(".opt-price .info-collateral").textContent=o.collateral)}).catch(t=>console.warn(t))},async liquidityPool(){const e=await v();document.querySelector(".liquidity-pool .pb-price-end").textContent=e.gross,S.progressBar(document.querySelector(".liquidity-pool"),e.perc)},setTrade(){document.querySelector(".opt-price .btn").addEventListener("click",async r=>{r.preventDefault();const a=[{name:`${l.getActiveItem(document.querySelector(".opt-buysell"))}:`,span:`call on ${s()} - ${c()}`,class:"to-buy"},{name:"Strike:",span:"-",class:"to-strike"},{name:"Expiry:",span:"-",class:"to-expiry"},{name:"Amount:",span:document.querySelector(".opt-amount input").value,class:"to-amount"},{name:"Implied Volatility:",span:"-",class:"to-volatility"},{name:"Premium:",span:"-",class:"to-premium"},{name:"Collateral:",span:"-",class:"to-collateral"}];n("Trade overview",p(a,"tradeoverview")),i.getValues(document.querySelector(".opt-strike"),document.querySelector(".overlay-popup .to-strike span")),i.getValues(document.querySelector(".opt-expiry"),document.querySelector(".overlay-popup .to-expiry span"),!0),this.optPrice({volatility:document.querySelector(".overlay-popup .to-volatility span"),premium:document.querySelector(".overlay-popup .to-premium span"),collateral:document.querySelector(".overlay-popup .to-collateral span")})})}};export{w as default};
