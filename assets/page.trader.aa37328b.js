import{c as l,d as p,s as u,h as m}from"./main.e248b881.js";import{a as d,b as y,d as v,e as S,f as b}from"./web3.80c68ef7.js";import c from"./component.dropdownSelect.b47ca7a9.js";import q from"./component.percentageBar.c796d439.js";import n from"./component.toggleSwitches.9948d56e.js";import h from"./component.tradingviewWidget.16639953.js";var P={globals:{elem:document.querySelector(".trader"),init:!0},init(){this.optExpiry(),this.setTrade();const t={childList:!0,attributes:!0,attributeFilter:["sidenav-activechange","sidenav-refreshprice"]};new MutationObserver(e=>{console.log("sidenav has changed from Trader!");for(let i of e)if(i.type==="attributes")switch(i.attributeName){case"sidenav-activechange":h.createGraph(),this.optStrike(),this.optPrice(),this.liquidityPool(),this.globals.init||this.optToken();break;case"sidenav-refreshprice":this.optPrice(),document.querySelector(".overlay-popup")&&this.optPrice(!0);break}this.globals.init=!1}).observe(this.globals.elem.querySelector(".sidenav"),t);const o={attributes:!0,attributeFilter:["ts-activechanged","dds-updated"]},a=new MutationObserver(e=>{for(let i of e)(i.attributeName==="ts-activechanged"||i.attributeName==="dds-updated")&&(this.optPrice(),i.target.classList.contains("opt-callput")?this.optStrike():i.target.classList.contains("opt-expiry")&&this.optToken())});a.observe(document.querySelector(".opt-buysell"),o),a.observe(document.querySelector(".opt-callput"),o),a.observe(document.querySelector(".opt-token"),o),a.observe(document.querySelector(".opt-strike"),o),a.observe(document.querySelector(".opt-expiry"),o);const r=new MutationObserver(e=>{this.optToken(),r.disconnect()});r.observe(document.querySelector(".opt-expiry .ds-value1"),{childList:!0})},async optToken(){const t=document.querySelector(".opt-expiry .ds-value1").textContent.replace("Days","").replace("Day","").trim(),s=await d(null,t);document.querySelector(".opt-token .ts-token").textContent=s},optStrike(){const t=n.getActiveItem(document.querySelector(".opt-callput")).toLowerCase()==="call";c.createListItems(document.querySelector(".opt-strike"),y(null,t),!1)},optPrice(t=!1){const s=n.getActiveItem(document.querySelector(".opt-buysell")).toLowerCase()==="buy",o=n.getActiveItem(document.querySelector(".opt-callput")).toLowerCase()==="call",a=n.getActiveItem(document.querySelector(".opt-token"),!0);new Promise((r,e)=>{setTimeout(()=>{r({strike:document.querySelector(".opt-strike .ds-value1").textContent.trim(),expiry:document.querySelector(".opt-expiry .ds-value1").textContent.replace("Days","").replace("Day","").trim()})},this.globals.init?2e3:500)}).then(async r=>{const e=await v(null,l(),s,o,a,r.strike,1e-5,r.expiry);t?(document.querySelector(".overlay-popup .to-volatility span").textContent=e.volatility,document.querySelector(".overlay-popup .to-premium span").textContent=e.premium,document.querySelector(".overlay-popup .to-collateral span").textContent=e.collateral):(document.querySelector(".opt-price .info-volatility").textContent=e.volatility,document.querySelector(".opt-price .info-premium").textContent=e.premium,document.querySelector(".opt-price .info-collateral").textContent=e.collateral)}).catch(r=>console.warn(r))},async liquidityPool(){const t=await S();document.querySelector(".liquidity-pool .pb-price-end").textContent=t.gross,q.progressBar(document.querySelector(".liquidity-pool"),t.perc)},optExpiry(){c.createListItems(document.querySelector(".opt-expiry"),b())},setTrade(){document.querySelector(".opt-price .btn").addEventListener("click",async s=>{s.preventDefault();const o=[{name:`${n.getActiveItem(document.querySelector(".opt-buysell"))}:`,span:`call on ${l()} - ${p()}`,class:"to-buy"},{name:"Strike:",span:"-",class:"to-strike"},{name:"Expiry:",span:"-",class:"to-expiry"},{name:"Amount:",span:document.querySelector(".opt-amount input").value,class:"to-amount"},{name:"Implied Volatility:",span:"-",class:"to-volatility"},{name:"Premium:",span:"-",class:"to-premium"},{name:"Collateral:",span:"-",class:"to-collateral"}];u("Trade overview",m(o,"tradeoverview")),c.getValues(document.querySelector(".opt-strike"),document.querySelector(".overlay-popup .to-strike span")),c.getValues(document.querySelector(".opt-expiry"),document.querySelector(".overlay-popup .to-expiry span"),!0),this.optPrice(!0)})}};export{P as default};
