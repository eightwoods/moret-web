import{c as u,d as p,s as m,h as d}from"./main.49da27fd.js";import{a as y,b as v,d as S,e as q,f as b}from"./web3.c9302880.js";import s from"./component.dropdownSelect.63718a2d.js";import h from"./component.percentageBar.c0101ce5.js";import c from"./component.toggleSwitches.d31686b5.js";import k from"./component.tradingviewWidget.b4c5d600.js";var T={globals:{elem:document.querySelector(".trader"),init:!0},init(){this.optAmount(),this.optExpiry(),this.buttonTrade();const e={childList:!0,attributes:!0,attributeFilter:["sidenav-activechange","sidenav-refreshprice"]};new MutationObserver(t=>{console.log("sidenav has changed from Trader!");for(let a of t)if(a.type==="attributes")switch(a.attributeName){case"sidenav-activechange":k.createGraph(),this.optTokenName(),document.querySelector(".opt-strike").removeAttribute("dds-selected"),this.optStrike(!0),this.optPrice(),this.liquidityPool(),this.globals.init||this.optToken();break;case"sidenav-refreshprice":this.optPrice(),document.querySelector(".overlay-popup")&&this.optPrice(!0);break}this.globals.init=!1}).observe(this.globals.elem.querySelector(".sidenav"),e);const n={attributes:!0,attributeFilter:["ts-activechanged","dds-updated"]},i=new MutationObserver(t=>{for(let a of t)if(a.attributeName==="ts-activechanged"||a.attributeName==="dds-updated"){if(a.target.classList.contains("opt-callput")){const l=document.querySelector(".opt-strike");parseInt(l.getAttribute("dds-selected"))===0&&s.valueFromInputField(l,l.querySelector(".ds-value1").textContent),this.optStrike()}else a.target.classList.contains("opt-expiry")&&this.optToken();this.optPrice()}});i.observe(document.querySelector(".opt-buysell"),n),i.observe(document.querySelector(".opt-callput"),n),i.observe(document.querySelector(".opt-token"),n),i.observe(document.querySelector(".opt-strike"),n),i.observe(document.querySelector(".opt-expiry"),n);const r=new MutationObserver(t=>{this.optToken(),r.disconnect()});r.observe(document.querySelector(".opt-expiry .ds-value1"),{childList:!0})},optTokenName(){document.querySelector(".opt-token .ts-token-name").textContent=u()},async optToken(){const e=document.querySelector(".opt-expiry .ds-value1").textContent.replace("Days","").replace("Day","").trim(),o=await y(null,e);document.querySelector(".opt-token .ts-token").textContent=o},optStrike(e=!1){const o=c.getActiveItem(document.querySelector(".opt-callput")).toLowerCase()==="call";s.createListItems(document.querySelector(".opt-strike"),v(null,o),!1,e)},optAmount(){document.querySelector("input[name='opt-amount']").addEventListener("keydown",o=>{o.keyCode==13&&this.optPrice()},!1)},optExpiry(){s.createListItems(document.querySelector(".opt-expiry"),S())},optPrice(e=!1){const o=c.getActiveItem(document.querySelector(".opt-buysell")).toLowerCase()==="buy",n=c.getActiveItem(document.querySelector(".opt-callput")).toLowerCase()==="call",i=c.getActiveItem(document.querySelector(".opt-token"),!0);new Promise((r,t)=>{setTimeout(()=>{r({strike:document.querySelector(".opt-strike .ds-value1").textContent.trim(),amount:document.querySelector("input[name='opt-amount']").value,expiry:document.querySelector(".opt-expiry .ds-value1").textContent.replace("Days","").replace("Day","").trim()})},this.globals.init?2e3:500)}).then(async r=>{const t=await q(null,u(),o,n,i,r.strike,r.amount,r.expiry);e?(document.querySelector(".overlay-popup .to-volatility span").textContent=t.volatility,document.querySelector(".overlay-popup .to-premium span").textContent=t.premium,document.querySelector(".overlay-popup .to-collateral span").textContent=t.collateral):(document.querySelector(".opt-price .info-volatility").textContent=t.volatility,document.querySelector(".opt-price .info-premium").textContent=t.premium,document.querySelector(".opt-price .info-collateral").textContent=t.collateral)}).catch(r=>console.warn(r))},async liquidityPool(){const e=await b();document.querySelector(".liquidity-pool .pb-price-end").textContent=e.gross,h.progressBar(document.querySelector(".liquidity-pool"),e.perc)},buttonTrade(){document.querySelector(".opt-price .btn").addEventListener("click",async o=>{o.preventDefault();const n=[{name:`${c.getActiveItem(document.querySelector(".opt-buysell"))}:`,span:`call on ${u()} - ${p()}`,class:"to-buy"},{name:"Strike:",span:"-",class:"to-strike"},{name:"Expiry:",span:"-",class:"to-expiry"},{name:"Amount:",span:document.querySelector(".opt-amount input").value,class:"to-amount"},{name:"Implied Volatility:",span:"-",class:"to-volatility"},{name:"Premium:",span:"-",class:"to-premium"},{name:"Collateral:",span:"-",class:"to-collateral"}];m("Trade overview",d(n,"tradeoverview")),s.insertValues(document.querySelector(".opt-strike"),document.querySelector(".overlay-popup .to-strike span")),s.insertValues(document.querySelector(".opt-expiry"),document.querySelector(".overlay-popup .to-expiry span"),!0),this.optPrice(!0)})}};export{T as default};
