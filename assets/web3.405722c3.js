import{b as q,g as C,e as S}from"./main.beffe511.js";var V=20,T=1,b=1e6,I=1e6,U=-7,W=21,F=!1,N="[big.js] ",m=N+"Invalid ",j=m+"decimal places",L=m+"rounding mode",O=N+"Division by zero",l={},v=void 0,$=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function d(){function t(r){var e=this;if(!(e instanceof t))return r===v?d():new t(r);if(r instanceof t)e.s=r.s,e.e=r.e,e.c=r.c.slice();else{if(typeof r!="string"){if(t.strict===!0&&typeof r!="bigint")throw TypeError(m+"value");r=r===0&&1/r<0?"-0":String(r)}z(e,r)}e.constructor=t}return t.prototype=l,t.DP=V,t.RM=T,t.NE=U,t.PE=W,t.strict=F,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}function z(t,r){var e,o,i;if(!$.test(r))throw Error(m+"number");for(t.s=r.charAt(0)=="-"?(r=r.slice(1),-1):1,(e=r.indexOf("."))>-1&&(r=r.replace(".","")),(o=r.search(/e/i))>0?(e<0&&(e=o),e+=+r.slice(o+1),r=r.substring(0,o)):e<0&&(e=r.length),i=r.length,o=0;o<i&&r.charAt(o)=="0";)++o;if(o==i)t.c=[t.e=0];else{for(;i>0&&r.charAt(--i)=="0";);for(t.e=e-o-1,t.c=[],e=0;o<=i;)t.c[e++]=+r.charAt(o++)}return t}function P(t,r,e,o){var i=t.c;if(e===v&&(e=t.constructor.RM),e!==0&&e!==1&&e!==2&&e!==3)throw Error(L);if(r<1)o=e===3&&(o||!!i[0])||r===0&&(e===1&&i[0]>=5||e===2&&(i[0]>5||i[0]===5&&(o||i[1]!==v))),i.length=1,o?(t.e=t.e-r+1,i[0]=1):i[0]=t.e=0;else if(r<i.length){if(o=e===1&&i[r]>=5||e===2&&(i[r]>5||i[r]===5&&(o||i[r+1]!==v||i[r-1]&1))||e===3&&(o||!!i[0]),i.length=r--,o)for(;++i[r]>9;)i[r]=0,r--||(++t.e,i.unshift(1));for(r=i.length;!i[--r];)i.pop()}return t}function M(t,r,e){var o=t.e,i=t.c.join(""),s=i.length;if(r)i=i.charAt(0)+(s>1?"."+i.slice(1):"")+(o<0?"e":"e+")+o;else if(o<0){for(;++o;)i="0"+i;i="0."+i}else if(o>0)if(++o>s)for(o-=s;o--;)i+="0";else o<s&&(i=i.slice(0,o)+"."+i.slice(o));else s>1&&(i=i.charAt(0)+"."+i.slice(1));return t.s<0&&e?"-"+i:i}l.abs=function(){var t=new this.constructor(this);return t.s=1,t};l.cmp=function(t){var r,e=this,o=e.c,i=(t=new e.constructor(t)).c,s=e.s,f=t.s,n=e.e,a=t.e;if(!o[0]||!i[0])return o[0]?s:i[0]?-f:0;if(s!=f)return s;if(r=s<0,n!=a)return n>a^r?1:-1;for(f=(n=o.length)<(a=i.length)?n:a,s=-1;++s<f;)if(o[s]!=i[s])return o[s]>i[s]^r?1:-1;return n==a?0:n>a^r?1:-1};l.div=function(t){var r=this,e=r.constructor,o=r.c,i=(t=new e(t)).c,s=r.s==t.s?1:-1,f=e.DP;if(f!==~~f||f<0||f>b)throw Error(j);if(!i[0])throw Error(O);if(!o[0])return t.s=s,t.c=[t.e=0],t;var n,a,c,w,u,E=i.slice(),B=n=i.length,_=o.length,h=o.slice(0,n),g=h.length,x=t,k=x.c=[],R=0,D=f+(x.e=r.e-t.e)+1;for(x.s=s,s=D<0?0:D,E.unshift(0);g++<n;)h.push(0);do{for(c=0;c<10;c++){if(n!=(g=h.length))w=n>g?1:-1;else for(u=-1,w=0;++u<n;)if(i[u]!=h[u]){w=i[u]>h[u]?1:-1;break}if(w<0){for(a=g==n?i:E;g;){if(h[--g]<a[g]){for(u=g;u&&!h[--u];)h[u]=9;--h[u],h[g]+=10}h[g]-=a[g]}for(;!h[0];)h.shift()}else break}k[R++]=w?c:++c,h[0]&&w?h[g]=o[B]||0:h=[o[B]]}while((B++<_||h[0]!==v)&&s--);return!k[0]&&R!=1&&(k.shift(),x.e--,D--),R>D&&P(x,D,e.RM,h[0]!==v),x};l.eq=function(t){return this.cmp(t)===0};l.gt=function(t){return this.cmp(t)>0};l.gte=function(t){return this.cmp(t)>-1};l.lt=function(t){return this.cmp(t)<0};l.lte=function(t){return this.cmp(t)<1};l.minus=l.sub=function(t){var r,e,o,i,s=this,f=s.constructor,n=s.s,a=(t=new f(t)).s;if(n!=a)return t.s=-a,s.plus(t);var c=s.c.slice(),w=s.e,u=t.c,E=t.e;if(!c[0]||!u[0])return u[0]?t.s=-a:c[0]?t=new f(s):t.s=1,t;if(n=w-E){for((i=n<0)?(n=-n,o=c):(E=w,o=u),o.reverse(),a=n;a--;)o.push(0);o.reverse()}else for(e=((i=c.length<u.length)?c:u).length,n=a=0;a<e;a++)if(c[a]!=u[a]){i=c[a]<u[a];break}if(i&&(o=c,c=u,u=o,t.s=-t.s),(a=(e=u.length)-(r=c.length))>0)for(;a--;)c[r++]=0;for(a=r;e>n;){if(c[--e]<u[e]){for(r=e;r&&!c[--r];)c[r]=9;--c[r],c[e]+=10}c[e]-=u[e]}for(;c[--a]===0;)c.pop();for(;c[0]===0;)c.shift(),--E;return c[0]||(t.s=1,c=[E=0]),t.c=c,t.e=E,t};l.mod=function(t){var r,e=this,o=e.constructor,i=e.s,s=(t=new o(t)).s;if(!t.c[0])throw Error(O);return e.s=t.s=1,r=t.cmp(e)==1,e.s=i,t.s=s,r?new o(e):(i=o.DP,s=o.RM,o.DP=o.RM=0,e=e.div(t),o.DP=i,o.RM=s,this.minus(e.times(t)))};l.neg=function(){var t=new this.constructor(this);return t.s=-t.s,t};l.plus=l.add=function(t){var r,e,o,i=this,s=i.constructor;if(t=new s(t),i.s!=t.s)return t.s=-t.s,i.minus(t);var f=i.e,n=i.c,a=t.e,c=t.c;if(!n[0]||!c[0])return c[0]||(n[0]?t=new s(i):t.s=i.s),t;if(n=n.slice(),r=f-a){for(r>0?(a=f,o=c):(r=-r,o=n),o.reverse();r--;)o.push(0);o.reverse()}for(n.length-c.length<0&&(o=c,c=n,n=o),r=c.length,e=0;r;n[r]%=10)e=(n[--r]=n[r]+c[r]+e)/10|0;for(e&&(n.unshift(e),++a),r=n.length;n[--r]===0;)n.pop();return t.c=n,t.e=a,t};l.pow=function(t){var r=this,e=new r.constructor("1"),o=e,i=t<0;if(t!==~~t||t<-I||t>I)throw Error(m+"exponent");for(i&&(t=-t);t&1&&(o=o.times(r)),t>>=1,!!t;)r=r.times(r);return i?e.div(o):o};l.prec=function(t,r){if(t!==~~t||t<1||t>b)throw Error(m+"precision");return P(new this.constructor(this),t,r)};l.round=function(t,r){if(t===v)t=0;else if(t!==~~t||t<-b||t>b)throw Error(j);return P(new this.constructor(this),t+this.e+1,r)};l.sqrt=function(){var t,r,e,o=this,i=o.constructor,s=o.s,f=o.e,n=new i("0.5");if(!o.c[0])return new i(o);if(s<0)throw Error(N+"No square root");s=Math.sqrt(o+""),s===0||s===1/0?(r=o.c.join(""),r.length+f&1||(r+="0"),s=Math.sqrt(r),f=((f+1)/2|0)-(f<0||f&1),t=new i((s==1/0?"5e":(s=s.toExponential()).slice(0,s.indexOf("e")+1))+f)):t=new i(s+""),f=t.e+(i.DP+=4);do e=t,t=n.times(e.plus(o.div(e)));while(e.c.slice(0,f).join("")!==t.c.slice(0,f).join(""));return P(t,(i.DP-=4)+t.e+1,i.RM)};l.times=l.mul=function(t){var r,e=this,o=e.constructor,i=e.c,s=(t=new o(t)).c,f=i.length,n=s.length,a=e.e,c=t.e;if(t.s=e.s==t.s?1:-1,!i[0]||!s[0])return t.c=[t.e=0],t;for(t.e=a+c,f<n&&(r=i,i=s,s=r,c=f,f=n,n=c),r=new Array(c=f+n);c--;)r[c]=0;for(a=n;a--;){for(n=0,c=f+a;c>a;)n=r[c]+s[a]*i[c-a-1]+n,r[c--]=n%10,n=n/10|0;r[c]=n}for(n?++t.e:r.shift(),a=r.length;!r[--a];)r.pop();return t.c=r,t};l.toExponential=function(t,r){var e=this,o=e.c[0];if(t!==v){if(t!==~~t||t<0||t>b)throw Error(j);for(e=P(new e.constructor(e),++t,r);e.c.length<t;)e.c.push(0)}return M(e,!0,!!o)};l.toFixed=function(t,r){var e=this,o=e.c[0];if(t!==v){if(t!==~~t||t<0||t>b)throw Error(j);for(e=P(new e.constructor(e),t+e.e+1,r),t=t+e.e+1;e.c.length<t;)e.c.push(0)}return M(e,!1,!!o)};l[Symbol.for("nodejs.util.inspect.custom")]=l.toJSON=l.toString=function(){var t=this,r=t.constructor;return M(t,t.e<=r.NE||t.e>=r.PE,!!t.c[0])};l.toNumber=function(){var t=Number(M(this,!0,!0));if(this.constructor.strict===!0&&!this.eq(t.toString()))throw Error(N+"Imprecise conversion");return t};l.toPrecision=function(t,r){var e=this,o=e.constructor,i=e.c[0];if(t!==v){if(t!==~~t||t<1||t>b)throw Error(m+"precision");for(e=P(new o(e),t,r);e.c.length<t;)e.c.push(0)}return M(e,t<=e.e||e.e<=o.NE||e.e>=o.PE,!!i)};l.valueOf=function(){var t=this,r=t.constructor;if(r.strict===!0)throw Error(N+"valueOf disallowed");return M(t,t.e<=r.NE||t.e>=r.PE,!0)};var H=d();const p=new Web3(window.ethereum),A=async(t,r,e)=>{const i=await(await fetch(r)).json();return new t.eth.Contract(i.abi,e)},J=async t=>{const e=await(await A(p,C("Moret.json"),q())).methods.getVolatilityChain(String(t)).call();return await A(p,C("VolatilityChain.json"),e)},Z=async t=>{const e=await(await J(t)).methods.queryPrice().call();return`$${H(p.utils.fromWei(e)).round(2).toNumber()}`},X=async t=>{const e=await(await A(p,C("Moret.json"),q())).methods.broker().call();return await(await A(p,C("MoretBroker.json"),e)).methods.getAllPools(t).call()},G=async t=>{const e=await(await A(p,C("Exchange.json"),S())).methods.vault().call(),o=await A(p,C("OptionVault.json"),e),i=await X(t);var s=0,f=0;for(let n=0;n<i.length;n++){const a=i[n],c=await o.methods.calcCapital(a,!1,!1).call(),w=await o.methods.calcCapital(a,!0,!1).call();s=s+parseFloat(p.utils.fromWei(c)),f=f+parseFloat(p.utils.fromWei(w))}return[s,Math.max(0,1-f/s)]};export{G as a,Z as g,p as w};
