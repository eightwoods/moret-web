import{g as i}from"./index.2d9ac2c0.js";import{n as r}from"./main.eb4af00b.js";import{w as u}from"./web3.692572fb.js";var p={init(){this.accountsConnect(),this.accountsChanged(),this.chainChanged(),this.accountsValidation()},createList(e,n){const o=document.createElement("ul");o.className=n;for(const t of e){const c=document.createElement("li");c.textContent=t.name,t.class?c.className=t.class:c.className=t.name.toLowerCase(),o.appendChild(c),n==="connectwallets"&&c.addEventListener("click",a=>{switch(a.target.className){case"metamask":this.connectMetaMask(c);break}},!1)}return o},overlayPopup(e=null,n=null,o=!1){r();const t=document.createElement("div");t.className="overlay-popup",document.body.appendChild(t);const c=document.createElement("div");if(c.className="op-box",t.appendChild(c),e){const l=document.createElement("div");l.className="op-title header-title m-b-24",l.textContent=e,c.appendChild(l)}const a=document.createElement("div");o?a.className="op-close hide":a.className="op-close cursor",c.appendChild(a),a.addEventListener("click",()=>{this.closeOverlayPopup()},!1);const s=document.createElement("div");s.className="op-content",s.appendChild(n),c.appendChild(s),i.from(c,{opacity:0,scale:.5})},closeOverlayPopup(){const e=document.querySelector(".overlay-popup");e&&(r(!1),i.to(document.querySelector(".op-box"),{opacity:0,scale:.5,duration:.35,onComplete:function(){e.remove()}}))},async connectMetaMask(e){e.textContent="Requesting...";try{await window.ethereum.request({method:"eth_requestAccounts"}).then(n=>{this.closeOverlayPopup(),this.accountsConnect()}).catch(n=>{throw console.log("eth_requestAccounts error",n),n})}catch(n){console.log("error",n)}},accountsConnect(){ethereum.request({method:"eth_accounts"}).then(e=>{const n=document.querySelector(".connection-button");if(n)if(e.length>0){n.textContent="";const o=String(e),t=document.createElement("div");t.className="in-border white-50 icon icon-account",t.textContent=`${o.substring(0,4)}...${o.substring(o.length-4)}`,n.appendChild(t)}else{const o=document.createElement("div");o.className="button",n.appendChild(o);const t=document.createElement("a");t.setAttribute("href","#"),t.className="btn btn-blue js-connectWallet",t.textContent="Connect wallet",o.appendChild(t),t.addEventListener("click",c=>{c.preventDefault();const a=[{name:"Metamask"},{name:"Walletconnect"},{name:"Coinbase"}];this.overlayPopup("Connect Wallet",this.createList(a,"connectwallets"))},!1)}}).catch(e=>{throw console.log("eth_accounts error",e),e})},accountsChanged(){window.ethereum.on("accountsChanged",e=>{this.accountsValidation(),e.length<1&&location.reload()})},chainChanged(){window.ethereum.on("chainChanged",e=>{this.accountsValidation()})},async accountsValidation(){if((await u.eth.getAccounts()).length>0){const n=await u.eth.getChainId();if(Number(n)===137)this.closeOverlayPopup();else{const o=[{name:"",class:"np-icon"},{name:"This is not a \u201CPolygon\u201D blockchain!",class:"np-text size-lgmd"}];this.overlayPopup(null,this.createList(o,"notpolygon"),!0)}}}};export{p as default};
